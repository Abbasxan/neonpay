

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>) &mdash; NEONPAY 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="SECURITY.html" />
    <link rel="prev" title="&lt;no title&gt;" href="API.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            NEONPAY
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Language Selection:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">NEONPAY Documentation (English)</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ru/index.html">Документация NEONPAY (Русский)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ru/index.html#id4">Индексы и таблицы</a></li>
<li class="toctree-l1"><a class="reference internal" href="../az/index.html">NEONPAY Sənədləri (Azərbaycan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../az/index.html#indekslr-v-cdvllr">İndekslər və Cədvəllər</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">NEONPAY Documentation (English)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">)</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id98">)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Documentation Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEONPAY</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">NEONPAY Documentation (English)</a></li>
      <li class="breadcrumb-item active">)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/en/FAQ.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p># Frequently Asked Questions (FAQ) - NEONPAY</p>
<p>Common questions and answers about NEONPAY library.</p>
<p>## Table of Contents</p>
<ol class="arabic simple">
<li><p>[General Questions](#general-questions)</p></li>
<li><p>[Installation &amp; Setup](#installation–setup)</p></li>
<li><p>[Payment Processing](#payment-processing)</p></li>
<li><p>[Error Handling](#error-handling)</p></li>
<li><p>[Security](#security)</p></li>
<li><p>[Production Deployment](#production-deployment)</p></li>
<li><p>[Troubleshooting](#troubleshooting)</p></li>
</ol>
<p>## General Questions</p>
<p>### What is NEONPAY?</p>
<p>NEONPAY is a Python library that simplifies Telegram Stars payments integration for bot developers. It provides a unified API for multiple bot libraries (Aiogram, Pyrogram, pyTelegramBotAPI, etc.) and handles payment processing automatically.</p>
<p>### Which bot libraries are supported?</p>
<p>NEONPAY supports:
- <strong>Aiogram</strong> (Recommended) - Modern async library
- <strong>Pyrogram</strong> - Popular MTProto library
- <strong>pyTelegramBotAPI</strong> - Simple synchronous library
- <strong>python-telegram-bot</strong> - Comprehensive library
- <strong>Raw Telegram Bot API</strong> - Direct HTTP requests</p>
<p>### What are Telegram Stars?</p>
<p>Telegram Stars is Telegram’s built-in virtual currency that users can purchase and use to pay for digital goods and services within bots. It’s officially supported by Telegram and provides a seamless payment experience.</p>
<p>### Is NEONPAY free to use?</p>
<p>Yes, NEONPAY is completely free and open-source. You only pay Telegram’s fees for processing Stars payments (typically 5% of the transaction amount).</p>
<p>## Installation &amp; Setup</p>
<p>### How do I install NEONPAY?</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>bash
# Basic installation
pip install neonpay</p>
<p># With specific bot library
pip install neonpay aiogram  # For Aiogram
pip install neonpay pyrogram  # For Pyrogram
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### How do I get started quickly?</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
from neonpay.factory import create_neonpay
from neonpay.core import PaymentStage, PaymentStatus</p>
<p># Initialize
neonpay = create_neonpay(bot_instance=your_bot)</p>
<p># Create payment stage
stage = PaymentStage(</p>
<blockquote>
<div><p>title=”Premium Access”,
description=”Unlock premium features”,
price=25,  # 25 Telegram Stars</p>
</div></blockquote>
<p>)
neonpay.create_payment_stage(“premium”, stage)</p>
<p># Handle payments
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><p>print(f”Payment received: {result.amount} stars”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>### Do I need to configure webhooks?</p>
<p>No, NEONPAY handles webhook configuration automatically for supported libraries. For Raw API, you need to set up webhooks manually.</p>
<p>### How do I choose the right bot library?</p>
<p><strong>For new projects:</strong> Use <strong>Aiogram</strong> - it’s modern, well-documented, and has excellent async support.</p>
<p><strong>For existing projects:</strong> Use whatever library you’re already using. NEONPAY works with all major libraries.</p>
<p>## Payment Processing</p>
<p>### How do I create different payment options?</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>python
# Donation options
donation_stages = [</p>
<blockquote>
<div><p>PaymentStage(“Support 1⭐”, “Help keep the bot running”, 1),
PaymentStage(“Support 10⭐”, “Support development”, 10),
PaymentStage(“Support 50⭐”, “Big support”, 50),</p>
</div></blockquote>
<p>]</p>
<p># Digital products
product_stages = [</p>
<blockquote>
<div><p>PaymentStage(“Premium Access”, “30 days premium”, 25),
PaymentStage(“Custom Theme”, “Personalized theme”, 15),</p>
</div></blockquote>
<p>]</p>
<p># Add all stages
for i, stage in enumerate(donation_stages):</p>
<blockquote>
<div><p>neonpay.create_payment_stage(f”donate_{i}”, stage)</p>
</div></blockquote>
<dl class="simple">
<dt>for i, stage in enumerate(product_stages):</dt><dd><p>neonpay.create_payment_stage(f”product_{i}”, stage)</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>### How do I handle different types of payments?</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><dl class="simple">
<dt>if result.stage_id.startswith(”<a href="#id175"><span class="problematic" id="id176">donate_</span></a>”):</dt><dd><p># Handle donation
await handle_donation(result)</p>
</dd>
<dt>elif result.stage_id.startswith(”<a href="#id177"><span class="problematic" id="id178">product_</span></a>”):</dt><dd><p># Handle product purchase
await handle_product_purchase(result)</p>
</dd>
<dt>else:</dt><dd><p># Handle other payments
await handle_other_payment(result)</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
<p>### Can I customize payment messages?</p>
<p>Yes, you can customize the thank you message:</p>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a><a href="#id35"><span class="problematic" id="id36">`</span></a>python
neonpay = create_neonpay(</p>
<blockquote>
<div><p>bot_instance=bot,
thank_you_message=”🎉 Thank you for your purchase! Your product is now active.”</p>
</div></blockquote>
<section id="id37">
<h1>)<a class="headerlink" href="#id37" title="Link to this heading"></a></h1>
<p>### How do I validate payment amounts?</p>
<p><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><p># Get expected amount for this stage
stage = neonpay.get_payment_stage(result.stage_id)
expected_amount = stage.price</p>
<dl class="simple">
<dt>if result.amount != expected_amount:</dt><dd><p>logger.warning(f”Amount mismatch: expected {expected_amount}, got {result.amount}”)
return</p>
</dd>
</dl>
<p># Process payment
await process_payment(result)</p>
</div></blockquote>
<p><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">`</span></a></p>
<p>## Error Handling</p>
<p>### What happens if a payment fails?</p>
<p>NEONPAY automatically handles payment failures and provides detailed error information:</p>
<p><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><p># Payment successful
await process_successful_payment(result)</p>
</dd>
<dt>elif result.status == PaymentStatus.FAILED:</dt><dd><p># Payment failed
await handle_payment_failure(result)</p>
</dd>
<dt>elif result.status == PaymentStatus.PENDING:</dt><dd><p># Payment pending
await handle_pending_payment(result)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id50"><span class="problematic" id="id51">``</span></a><a href="#id52"><span class="problematic" id="id53">`</span></a></p>
<p>### How do I handle network errors?</p>
<p><a href="#id54"><span class="problematic" id="id55">``</span></a><a href="#id56"><span class="problematic" id="id57">`</span></a>python
async def safe_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>await neonpay.send_payment(user_id, stage_id)</p>
</dd>
<dt>except PaymentError as e:</dt><dd><p>logger.error(f”Payment error: {e}”)
await bot.send_message(user_id, “Payment failed. Please try again.”)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>logger.error(f”Unexpected error: {e}”)
await bot.send_message(user_id, “Something went wrong. Please try again later.”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id58"><span class="problematic" id="id59">``</span></a><a href="#id60"><span class="problematic" id="id61">`</span></a></p>
<p>### What if the bot token is invalid?</p>
<p>NEONPAY will raise a <cite>ConfigurationError</cite> if the bot token is invalid:</p>
<p><a href="#id62"><span class="problematic" id="id63">``</span></a><a href="#id64"><span class="problematic" id="id65">`</span></a>python
try:</p>
<blockquote>
<div><p>neonpay = create_neonpay(bot_instance=bot)</p>
</div></blockquote>
<dl class="simple">
<dt>except ConfigurationError as e:</dt><dd><p>print(f”Configuration error: {e}”)
# Check your bot token</p>
</dd>
</dl>
<p><a href="#id66"><span class="problematic" id="id67">``</span></a><a href="#id68"><span class="problematic" id="id69">`</span></a></p>
<p>## Security</p>
<p>### How do I protect my bot token?</p>
<p>Never hardcode tokens in your source code:</p>
<p><a href="#id70"><span class="problematic" id="id71">``</span></a><a href="#id72"><span class="problematic" id="id73">`</span></a>python
# ❌ Wrong
BOT_TOKEN = “1234567890:ABCdefGHIjklMNOpqrsTUVwxyz”</p>
<p># ✅ Correct
import os
BOT_TOKEN = os.getenv(“BOT_TOKEN”)
<a href="#id74"><span class="problematic" id="id75">``</span></a><a href="#id76"><span class="problematic" id="id77">`</span></a></p>
<p>### How do I validate user permissions?</p>
<p><a href="#id78"><span class="problematic" id="id79">``</span></a><a href="#id80"><span class="problematic" id="id81">`</span></a>python
async def safe_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><p># Check if user can make payments
if not await user_can_pay(user_id):</p>
<blockquote>
<div><p>await bot.send_message(user_id, “You don’t have permission to make payments.”)
return</p>
</div></blockquote>
<p># Check if user has reached payment limit
if await user_payment_limit_reached(user_id):</p>
<blockquote>
<div><p>await bot.send_message(user_id, “You’ve reached your payment limit.”)
return</p>
</div></blockquote>
<p># Send payment
await neonpay.send_payment(user_id, stage_id)</p>
</div></blockquote>
<p><a href="#id82"><span class="problematic" id="id83">``</span></a><a href="#id84"><span class="problematic" id="id85">`</span></a></p>
<p>### How do I prevent payment fraud?</p>
<p><a href="#id86"><span class="problematic" id="id87">``</span></a><a href="#id88"><span class="problematic" id="id89">`</span></a>python
class PaymentValidator:</p>
<blockquote>
<div><dl>
<dt>def __init__(self):</dt><dd><p>self.user_payments = defaultdict(list)
self.max_payments_per_hour = 5</p>
</dd>
<dt>async def validate_payment(self, user_id: int, stage_id: str) -&gt; bool:</dt><dd><p># Check payment frequency
now = time.time()
recent_payments = [</p>
<blockquote>
<div><p>t for t in self.user_payments[user_id]
if now - t &lt; 3600  # Last hour</p>
</div></blockquote>
<p>]</p>
<dl class="simple">
<dt>if len(recent_payments) &gt;= self.max_payments_per_hour:</dt><dd><p>return False</p>
</dd>
</dl>
<p># Check for suspicious patterns
if await self.is_suspicious_user(user_id):</p>
<blockquote>
<div><p>return False</p>
</div></blockquote>
<p>return True</p>
</dd>
<dt>async def record_payment(self, user_id: int):</dt><dd><p>self.user_payments[user_id].append(time.time())</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id90"><span class="problematic" id="id91">``</span></a><a href="#id92"><span class="problematic" id="id93">`</span></a></p>
<p>## Production Deployment</p>
<p>### How do I deploy to production?</p>
<p>1. <strong>Use environment variables:</strong>
<code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">os</span>
<span class="pre">BOT_TOKEN</span> <span class="pre">=</span> <span class="pre">os.getenv(&quot;BOT_TOKEN&quot;)</span>
<span class="pre">DATABASE_URL</span> <span class="pre">=</span> <span class="pre">os.getenv(&quot;DATABASE_URL&quot;)</span>
<span class="pre">`</span></code></p>
<p>2. <strong>Set up proper logging:</strong>
<a href="#id94"><span class="problematic" id="id95">``</span></a><a href="#id96"><span class="problematic" id="id97">`</span></a>python
import logging
logging.basicConfig(</p>
<blockquote>
<div><p>level=logging.INFO,
format=”%(asctime)s - %(name)s - %(levelname)s - %(message)s”</p>
</div></blockquote>
</section>
<section id="id98">
<h1>)<a class="headerlink" href="#id98" title="Link to this heading"></a></h1>
<p>3. <strong>Use a production database:</strong>
<a href="#id99"><span class="problematic" id="id100">``</span></a><a href="#id101"><span class="problematic" id="id102">`</span></a>python
# Replace in-memory storage with database
import asyncpg</p>
<dl>
<dt>async def store_payment(payment_data):</dt><dd><p>conn = await asyncpg.connect(DATABASE_URL)
await conn.execute(</p>
<blockquote>
<div><p>“INSERT INTO payments (user_id, amount, stage_id, created_at) VALUES ($1, $2, $3, NOW())”,
payment_data[‘user_id’], payment_data[‘amount’], payment_data[‘stage_id’]</p>
</div></blockquote>
<p>)
await conn.close()</p>
</dd>
</dl>
<p><a href="#id103"><span class="problematic" id="id104">``</span></a><a href="#id105"><span class="problematic" id="id106">`</span></a></p>
<p>### How do I monitor payments?</p>
<p><a href="#id107"><span class="problematic" id="id108">``</span></a><a href="#id109"><span class="problematic" id="id110">`</span></a>python
class PaymentMonitor:</p>
<blockquote>
<div><dl>
<dt>def __init__(self):</dt><dd><p>self.payment_stats = defaultdict(int)</p>
</dd>
<dt>async def log_payment(self, result):</dt><dd><p>self.payment_stats[‘total_payments’] += 1
self.payment_stats[‘total_amount’] += result.amount</p>
<p># Log to database
await self.store_payment_log(result)</p>
<p># Send alerts for high volume
if self.payment_stats[‘total_payments’] % 100 == 0:</p>
<blockquote>
<div><p>await self.send_volume_alert()</p>
</div></blockquote>
</dd>
<dt>async def get_stats(self):</dt><dd><p>return dict(self.payment_stats)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id111"><span class="problematic" id="id112">``</span></a><a href="#id113"><span class="problematic" id="id114">`</span></a></p>
<p>### How do I handle high traffic?</p>
<p><a href="#id115"><span class="problematic" id="id116">``</span></a><a href="#id117"><span class="problematic" id="id118">`</span></a>python
# Use connection pooling
import asyncpg</p>
<dl>
<dt>class DatabasePool:</dt><dd><dl>
<dt>def __init__(self, database_url: str):</dt><dd><p>self.pool = None
self.database_url = database_url</p>
</dd>
<dt>async def initialize(self):</dt><dd><dl class="simple">
<dt>self.pool = await asyncpg.create_pool(</dt><dd><p>self.database_url,
min_size=10,
max_size=20</p>
</dd>
</dl>
<p>)</p>
</dd>
<dt>async def execute(self, query, <a href="#id119"><span class="problematic" id="id120">*</span></a>args):</dt><dd><dl class="simple">
<dt>async with self.pool.acquire() as conn:</dt><dd><p>return await conn.execute(query, <a href="#id121"><span class="problematic" id="id122">*</span></a>args)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id123"><span class="problematic" id="id124">``</span></a><a href="#id125"><span class="problematic" id="id126">`</span></a></p>
<p>## Troubleshooting</p>
<p>### Payment not being sent</p>
<p><strong>Check:</strong>
1. Bot token is valid
2. User has started the bot
3. Payment stage exists
4. User ID is correct</p>
<p><a href="#id127"><span class="problematic" id="id128">``</span></a><a href="#id129"><span class="problematic" id="id130">`</span></a>python
# Debug payment sending
async def debug_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><p># Check if stage exists
stage = neonpay.get_payment_stage(stage_id)
if not stage:</p>
<blockquote>
<div><p>print(f”Stage {stage_id} not found”)
return</p>
</div></blockquote>
<p># Check if user exists
try:</p>
<blockquote>
<div><p>user = await bot.get_chat(user_id)
print(f”User found: {user.first_name}”)</p>
</div></blockquote>
<dl class="simple">
<dt>except Exception as e:</dt><dd><p>print(f”User not found: {e}”)
return</p>
</dd>
</dl>
<p># Send payment
try:</p>
<blockquote>
<div><p>await neonpay.send_payment(user_id, stage_id)
print(“Payment sent successfully”)</p>
</div></blockquote>
<dl class="simple">
<dt>except Exception as e:</dt><dd><p>print(f”Payment failed: {e}”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id131"><span class="problematic" id="id132">``</span></a><a href="#id133"><span class="problematic" id="id134">`</span></a></p>
<p>### Payment callback not working</p>
<p><strong>Check:</strong>
1. <cite>&#64;neonpay.on_payment</cite> decorator is properly applied
2. Function is async
3. Bot is running and receiving updates</p>
<p><a href="#id135"><span class="problematic" id="id136">``</span></a><a href="#id137"><span class="problematic" id="id138">`</span></a>python
# Test payment callback
&#64;neonpay.on_payment
async def test_payment_handler(result):</p>
<blockquote>
<div><p>print(f”Payment callback triggered: {result}”)
# Add breakpoint here to debug</p>
</div></blockquote>
<p><a href="#id139"><span class="problematic" id="id140">``</span></a><a href="#id141"><span class="problematic" id="id142">`</span></a></p>
<p>### Bot not responding to commands</p>
<p><strong>Check:</strong>
1. Bot token is correct
2. Bot is running
3. Commands are properly registered
4. Network connectivity</p>
<p><a href="#id143"><span class="problematic" id="id144">``</span></a><a href="#id145"><span class="problematic" id="id146">`</span></a>python
# Test bot connectivity
async def test_bot():</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>me = await bot.get_me()
print(f”Bot is running: {me.first_name}”)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f”Bot connection failed: {e}”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id147"><span class="problematic" id="id148">``</span></a><a href="#id149"><span class="problematic" id="id150">`</span></a></p>
<p>### Database connection issues</p>
<p><a href="#id151"><span class="problematic" id="id152">``</span></a><a href="#id153"><span class="problematic" id="id154">`</span></a>python
# Test database connection
async def test_database():</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>conn = await asyncpg.connect(DATABASE_URL)
result = await conn.fetchval(“SELECT 1”)
print(f”Database connected: {result}”)
await conn.close()</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f”Database connection failed: {e}”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id155"><span class="problematic" id="id156">``</span></a><a href="#id157"><span class="problematic" id="id158">`</span></a></p>
<p>## Common Issues</p>
<p>### “Payment stage not found”</p>
<p>This happens when you try to send a payment for a stage that doesn’t exist:</p>
<p><a href="#id159"><span class="problematic" id="id160">``</span></a><a href="#id161"><span class="problematic" id="id162">`</span></a>python
# Check available stages
stages = neonpay.list_payment_stages()
print(f”Available stages: {list(stages.keys())}”)</p>
<p># Create stage if missing
if “premium” not in stages:</p>
<blockquote>
<div><p>stage = PaymentStage(“Premium”, “Premium access”, 25)
neonpay.create_payment_stage(“premium”, stage)</p>
</div></blockquote>
<p><a href="#id163"><span class="problematic" id="id164">``</span></a><a href="#id165"><span class="problematic" id="id166">`</span></a></p>
<p>### “Failed to send invoice”</p>
<p>This usually means:
1. Bot token is invalid
2. User hasn’t started the bot
3. User ID is incorrect</p>
<p><a href="#id167"><span class="problematic" id="id168">``</span></a><a href="#id169"><span class="problematic" id="id170">`</span></a>python
# Debug invoice sending
async def debug_invoice(user_id: int, stage_id: str):</p>
<blockquote>
<div><dl>
<dt>try:</dt><dd><p># Check bot info
me = await bot.get_me()
print(f”Bot: {me.first_name} (&#64;{me.username})”)</p>
<p># Check user
user = await bot.get_chat(user_id)
print(f”User: {user.first_name} (&#64;{user.username})”)</p>
<p># Send payment
await neonpay.send_payment(user_id, stage_id)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f”Error: {e}”)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id171"><span class="problematic" id="id172">``</span></a><a href="#id173"><span class="problematic" id="id174">`</span></a></p>
<p>### “Payment callback not triggered”</p>
<p>Make sure:
1. Function is decorated with <cite>&#64;neonpay.on_payment</cite>
2. Function is async
3. Bot is receiving updates</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">#</span> <span class="pre">Test</span> <span class="pre">callback</span> <span class="pre">registration</span>
<span class="pre">stats</span> <span class="pre">=</span> <span class="pre">neonpay.get_stats()</span>
<span class="pre">print(f&quot;Callbacks</span> <span class="pre">registered:</span> <span class="pre">{stats['registered_callbacks']}&quot;)</span>
<span class="pre">`</span></code></p>
<p>## Getting Help</p>
<p>### Where can I get help?</p>
<ol class="arabic simple">
<li><p><strong>Documentation</strong>: Check the [examples](../../examples/) directory</p></li>
<li><p><strong>Community</strong>: Join our [Telegram community](<a class="reference external" href="https://t.me/neonpay_community">https://t.me/neonpay_community</a>)</p></li>
<li><p><strong>Issues</strong>: Open an issue on [GitHub](<a class="reference external" href="https://github.com/Abbasxan/neonpay/issues">https://github.com/Abbasxan/neonpay/issues</a>)</p></li>
<li><p><strong>Email</strong>: Contact support at [<a class="reference external" href="mailto:support&#37;&#52;&#48;neonpay&#46;com">support<span>&#64;</span>neonpay<span>&#46;</span>com</a>](<a class="reference external" href="mailto:support&#37;&#52;&#48;neonpay&#46;com">mailto:support<span>&#64;</span>neonpay<span>&#46;</span>com</a>)</p></li>
</ol>
<p>### How do I report bugs?</p>
<p>When reporting bugs, please include:
1. Python version
2. NEONPAY version
3. Bot library and version
4. Error message and stack trace
5. Steps to reproduce</p>
<p>### How do I request features?</p>
<p>Feature requests are welcome! Please:
1. Check if the feature already exists
2. Describe the use case
3. Provide example code if possible
4. Open an issue on GitHub</p>
<p>—</p>
<p><strong>Still have questions? Check the [examples](../../examples/) directory or contact support!</strong></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="API.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SECURITY.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NEONPAY Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>