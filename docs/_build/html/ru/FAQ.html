

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>) &mdash; NEONPAY 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="SECURITY.html" />
    <link rel="prev" title="&lt;no title&gt;" href="API.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            NEONPAY
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Language Selection:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../en/index.html">NEONPAY Documentation (English)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../en/index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NEONPAY (–†—É—Å—Å–∫–∏–π)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="README.html">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NEONPAY (–†—É—Å—Å–∫–∏–π)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id98">)</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id1">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id2">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#id3">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#id4">–ò–Ω–¥–µ–∫—Å—ã –∏ —Ç–∞–±–ª–∏—Ü—ã</a></li>
<li class="toctree-l1"><a class="reference internal" href="../az/index.html">NEONPAY S…ôn…ôdl…ôri (Az…ôrbaycan)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../az/index.html#indekslr-v-cdvllr">ƒ∞ndeksl…ôr v…ô C…ôdv…ôll…ôr</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../en/README.html">NEONPAY Documentation (English)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../en/FAQ.html">)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../en/FAQ.html#id98">)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Documentation Changelog</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NEONPAY</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NEONPAY (–†—É—Å—Å–∫–∏–π)</a></li>
      <li class="breadcrumb-item active">)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ru/FAQ.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p># –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ) - NEONPAY</p>
<p>–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –æ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ NEONPAY.</p>
<p>## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</p>
<ol class="arabic simple">
<li><p>[–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã](#–æ–±—â–∏–µ-–≤–æ–ø—Ä–æ—Å—ã)</p></li>
<li><p>[–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)</p></li>
<li><p>[–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–ø–ª–∞—Ç–µ–∂–µ–π)</p></li>
<li><p>[–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)</p></li>
<li><p>[–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)</p></li>
<li><p>[–ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#–ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)</p></li>
<li><p>[–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º)</p></li>
</ol>
<p>## –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã</p>
<p>### –ß—Ç–æ —Ç–∞–∫–æ–µ NEONPAY?</p>
<p>NEONPAY - —ç—Ç–æ Python –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è —É–ø—Ä–æ—â–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –ø–ª–∞—Ç–µ–∂–µ–π Telegram Stars –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±–æ—Ç–æ–≤. –û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π API –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ –±–æ—Ç–æ–≤ (Aiogram, Pyrogram, pyTelegramBotAPI –∏ –¥—Ä.) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏.</p>
<p>### –ö–∞–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±–æ—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è?</p>
<p>NEONPAY –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- <strong>Aiogram</strong> (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- <strong>Pyrogram</strong> - –ü–æ–ø—É–ª—è—Ä–Ω–∞—è MTProto –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- <strong>pyTelegramBotAPI</strong> - –ü—Ä–æ—Å—Ç–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- <strong>python-telegram-bot</strong> - –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- <strong>Raw Telegram Bot API</strong> - –ü—Ä—è–º—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã</p>
<p>### –ß—Ç–æ —Ç–∞–∫–æ–µ Telegram Stars?</p>
<p>Telegram Stars - —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –≤–∞–ª—é—Ç–∞ Telegram, –∫–æ—Ç–æ—Ä—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–æ–∫—É–ø–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–ø–ª–∞—Ç—ã —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥ –≤ –±–æ—Ç–∞—Ö. –û–Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Telegram –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ—Å—à–æ–≤–Ω—ã–π –æ–ø—ã—Ç –ø–ª–∞—Ç–µ–∂–µ–π.</p>
<p>### –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NEONPAY?</p>
<p>–î–∞, NEONPAY –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ—Å–ø–ª–∞—Ç–Ω–∞ –∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º. –í—ã –ø–ª–∞—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ –∫–æ–º–∏—Å—Å–∏—é Telegram –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–ª–∞—Ç–µ–∂–µ–π Stars (–æ–±—ã—á–Ω–æ 5% –æ—Ç —Å—É–º–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏).</p>
<p>## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</p>
<p>### –ö–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NEONPAY?</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>bash
# –ë–∞–∑–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install neonpay</p>
<p># –° –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –±–æ—Ç–∞
pip install neonpay aiogram  # –î–ª—è Aiogram
pip install neonpay pyrogram  # –î–ª—è Pyrogram
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>### –ö–∞–∫ –±—ã—Å—Ç—Ä–æ –Ω–∞—á–∞—Ç—å?</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
from neonpay.factory import create_neonpay
from neonpay.core import PaymentStage, PaymentStatus</p>
<p># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
neonpay = create_neonpay(bot_instance=–≤–∞—à_–±–æ—Ç)</p>
<p># –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ç–∞–ø–∞ –ø–ª–∞—Ç–µ–∂–∞
stage = PaymentStage(</p>
<blockquote>
<div><p>title=‚Äù–ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø‚Äù,
description=‚Äù–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏‚Äù,
price=25,  # 25 Telegram Stars</p>
</div></blockquote>
<p>)
neonpay.create_payment_stage(‚Äúpremium‚Äù, stage)</p>
<p># –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><p>print(f‚Äù–ü–ª–∞—Ç–µ–∂ –ø–æ–ª—É—á–µ–Ω: {result.amount} –∑–≤–µ–∑–¥‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>### –ù—É–∂–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å webhook?</p>
<p>–ù–µ—Ç, NEONPAY –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é webhook –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –î–ª—è Raw API –≤–∞–º –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤—Ä—É—á–Ω—É—é.</p>
<p>### –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –±–æ—Ç–∞?</p>
<p><strong>–î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <strong>Aiogram</strong> - –æ–Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è, —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∏–º–µ–µ—Ç –æ—Ç–ª–∏—á–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É async.</p>
<p><strong>–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª—é–±—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É, –∫–æ—Ç–æ—Ä—É—é –≤—ã —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ. NEONPAY —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏ –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏.</p>
<p>## –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π</p>
<p>### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π?</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>python
# –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–æ–Ω–∞—Ç–æ–≤
donation_stages = [</p>
<blockquote>
<div><p>PaymentStage(‚Äú–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 1‚≠ê‚Äù, ‚Äú–ü–æ–º–æ—á—å –±–æ—Ç—É —Ä–∞–±–æ—Ç–∞—Ç—å‚Äù, 1),
PaymentStage(‚Äú–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 10‚≠ê‚Äù, ‚Äú–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É‚Äù, 10),
PaymentStage(‚Äú–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 50‚≠ê‚Äù, ‚Äú–ë–æ–ª—å—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞‚Äù, 50),</p>
</div></blockquote>
<p>]</p>
<p># –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã
product_stages = [</p>
<blockquote>
<div><p>PaymentStage(‚Äú–ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø‚Äù, ‚Äú30 –¥–Ω–µ–π –ø—Ä–µ–º–∏—É–º‚Äù, 25),
PaymentStage(‚Äú–ö–∞—Å—Ç–æ–º–Ω–∞—è —Ç–µ–º–∞‚Äù, ‚Äú–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ–º–∞‚Äù, 15),</p>
</div></blockquote>
<p>]</p>
<p># –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —ç—Ç–∞–ø—ã
for i, stage in enumerate(donation_stages):</p>
<blockquote>
<div><p>neonpay.create_payment_stage(f‚Äùdonate_{i}‚Äù, stage)</p>
</div></blockquote>
<dl class="simple">
<dt>for i, stage in enumerate(product_stages):</dt><dd><p>neonpay.create_payment_stage(f‚Äùproduct_{i}‚Äù, stage)</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>### –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –ø–ª–∞—Ç–µ–∂–µ–π?</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><dl class="simple">
<dt>if result.stage_id.startswith(‚Äù<a href="#id175"><span class="problematic" id="id176">donate_</span></a>‚Äù):</dt><dd><p># –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–æ–Ω–∞—Ç
await handle_donation(result)</p>
</dd>
<dt>elif result.stage_id.startswith(‚Äù<a href="#id177"><span class="problematic" id="id178">product_</span></a>‚Äù):</dt><dd><p># –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–∫—É–ø–∫—É –ø—Ä–æ–¥—É–∫—Ç–∞
await handle_product_purchase(result)</p>
</dd>
<dt>else:</dt><dd><p># –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø–ª–∞—Ç–µ–∂–∏
await handle_other_payment(result)</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
<p>### –ú–æ–∂–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö?</p>
<p>–î–∞, –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏:</p>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a><a href="#id35"><span class="problematic" id="id36">`</span></a>python
neonpay = create_neonpay(</p>
<blockquote>
<div><p>bot_instance=bot,
thank_you_message=‚Äùüéâ –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∫—É–ø–∫—É! –í–∞—à –ø—Ä–æ–¥—É–∫—Ç —Ç–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–µ–Ω.‚Äù</p>
</div></blockquote>
<section id="id37">
<h1>)<a class="headerlink" href="#id37" title="Link to this heading">ÔÉÅ</a></h1>
<p>### –ö–∞–∫ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å—É–º–º—ã –ø–ª–∞—Ç–µ–∂–µ–π?</p>
<p><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><p># –ü–æ–ª—É—á–∏—Ç—å –æ–∂–∏–¥–∞–µ–º—É—é —Å—É–º–º—É –¥–ª—è —ç—Ç–æ–≥–æ —ç—Ç–∞–ø–∞
stage = neonpay.get_payment_stage(result.stage_id)
expected_amount = stage.price</p>
<dl class="simple">
<dt>if result.amount != expected_amount:</dt><dd><p>logger.warning(f‚Äù–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—É–º–º—ã: –æ–∂–∏–¥–∞–ª–æ—Å—å {expected_amount}, –ø–æ–ª—É—á–µ–Ω–æ {result.amount}‚Äù)
return</p>
</dd>
</dl>
<p># –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–ª–∞—Ç–µ–∂
await process_payment(result)</p>
</div></blockquote>
<p><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">`</span></a></p>
<p>## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</p>
<p>### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ –ø–ª–∞—Ç–µ–∂ –Ω–µ —É–¥–∞–ª—Å—è?</p>
<p>NEONPAY –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–∞—Ö:</p>
<p><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a>python
&#64;neonpay.on_payment
async def handle_payment(result):</p>
<blockquote>
<div><dl class="simple">
<dt>if result.status == PaymentStatus.COMPLETED:</dt><dd><p># –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω
await process_successful_payment(result)</p>
</dd>
<dt>elif result.status == PaymentStatus.FAILED:</dt><dd><p># –ü–ª–∞—Ç–µ–∂ –Ω–µ —É–¥–∞–ª—Å—è
await handle_payment_failure(result)</p>
</dd>
<dt>elif result.status == PaymentStatus.PENDING:</dt><dd><p># –ü–ª–∞—Ç–µ–∂ –≤ –æ–∂–∏–¥–∞–Ω–∏–∏
await handle_pending_payment(result)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id50"><span class="problematic" id="id51">``</span></a><a href="#id52"><span class="problematic" id="id53">`</span></a></p>
<p>### –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏?</p>
<p><a href="#id54"><span class="problematic" id="id55">``</span></a><a href="#id56"><span class="problematic" id="id57">`</span></a>python
async def safe_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>await neonpay.send_payment(user_id, stage_id)</p>
</dd>
<dt>except PaymentError as e:</dt><dd><p>logger.error(f‚Äù–û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞: {e}‚Äù)
await bot.send_message(user_id, ‚Äú–ü–ª–∞—Ç–µ–∂ –Ω–µ —É–¥–∞–ª—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.‚Äù)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>logger.error(f‚Äù–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {e}‚Äù)
await bot.send_message(user_id, ‚Äú–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id58"><span class="problematic" id="id59">``</span></a><a href="#id60"><span class="problematic" id="id61">`</span></a></p>
<p>### –ß—Ç–æ –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω?</p>
<p>NEONPAY –≤—ã–∑–æ–≤–µ—Ç <cite>ConfigurationError</cite>, –µ—Å–ª–∏ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω:</p>
<p><a href="#id62"><span class="problematic" id="id63">``</span></a><a href="#id64"><span class="problematic" id="id65">`</span></a>python
try:</p>
<blockquote>
<div><p>neonpay = create_neonpay(bot_instance=bot)</p>
</div></blockquote>
<dl class="simple">
<dt>except ConfigurationError as e:</dt><dd><p>print(f‚Äù–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: {e}‚Äù)
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω –±–æ—Ç–∞</p>
</dd>
</dl>
<p><a href="#id66"><span class="problematic" id="id67">``</span></a><a href="#id68"><span class="problematic" id="id69">`</span></a></p>
<p>## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</p>
<p>### –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞?</p>
<p>–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ:</p>
<p><a href="#id70"><span class="problematic" id="id71">``</span></a><a href="#id72"><span class="problematic" id="id73">`</span></a>python
# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
BOT_TOKEN = ‚Äú1234567890:ABCdefGHIjklMNOpqrsTUVwxyz‚Äù</p>
<p># ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
import os
BOT_TOKEN = os.getenv(‚ÄúBOT_TOKEN‚Äù)
<a href="#id74"><span class="problematic" id="id75">``</span></a><a href="#id76"><span class="problematic" id="id77">`</span></a></p>
<p>### –ö–∞–∫ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?</p>
<p><a href="#id78"><span class="problematic" id="id79">``</span></a><a href="#id80"><span class="problematic" id="id81">`</span></a>python
async def safe_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏
if not await user_can_pay(user_id):</p>
<blockquote>
<div><p>await bot.send_message(user_id, ‚Äú–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π.‚Äù)
return</p>
</div></blockquote>
<p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –¥–æ—Å—Ç–∏–≥ –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ª–∏–º–∏—Ç–∞ –ø–ª–∞—Ç–µ–∂–µ–π
if await user_payment_limit_reached(user_id):</p>
<blockquote>
<div><p>await bot.send_message(user_id, ‚Äú–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ –ø–ª–∞—Ç–µ–∂–µ–π.‚Äù)
return</p>
</div></blockquote>
<p># –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂
await neonpay.send_payment(user_id, stage_id)</p>
</div></blockquote>
<p><a href="#id82"><span class="problematic" id="id83">``</span></a><a href="#id84"><span class="problematic" id="id85">`</span></a></p>
<p>### –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏?</p>
<p><a href="#id86"><span class="problematic" id="id87">``</span></a><a href="#id88"><span class="problematic" id="id89">`</span></a>python
class PaymentValidator:</p>
<blockquote>
<div><dl>
<dt>def __init__(self):</dt><dd><p>self.user_payments = defaultdict(list)
self.max_payments_per_hour = 5</p>
</dd>
<dt>async def validate_payment(self, user_id: int, stage_id: str) -&gt; bool:</dt><dd><p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –ø–ª–∞—Ç–µ–∂–µ–π
now = time.time()
recent_payments = [</p>
<blockquote>
<div><p>t for t in self.user_payments[user_id]
if now - t &lt; 3600  # –ü–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å</p>
</div></blockquote>
<p>]</p>
<dl class="simple">
<dt>if len(recent_payments) &gt;= self.max_payments_per_hour:</dt><dd><p>return False</p>
</dd>
</dl>
<p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
if await self.is_suspicious_user(user_id):</p>
<blockquote>
<div><p>return False</p>
</div></blockquote>
<p>return True</p>
</dd>
<dt>async def record_payment(self, user_id: int):</dt><dd><p>self.user_payments[user_id].append(time.time())</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id90"><span class="problematic" id="id91">``</span></a><a href="#id92"><span class="problematic" id="id93">`</span></a></p>
<p>## –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ</p>
<p>### –ö–∞–∫ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–Ω?</p>
<p>1. <strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:</strong>
<code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">os</span>
<span class="pre">BOT_TOKEN</span> <span class="pre">=</span> <span class="pre">os.getenv(&quot;BOT_TOKEN&quot;)</span>
<span class="pre">DATABASE_URL</span> <span class="pre">=</span> <span class="pre">os.getenv(&quot;DATABASE_URL&quot;)</span>
<span class="pre">`</span></code></p>
<p>2. <strong>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong>
<a href="#id94"><span class="problematic" id="id95">``</span></a><a href="#id96"><span class="problematic" id="id97">`</span></a>python
import logging
logging.basicConfig(</p>
<blockquote>
<div><p>level=logging.INFO,
format=‚Äù%(asctime)s - %(name)s - %(levelname)s - %(message)s‚Äù</p>
</div></blockquote>
</section>
<section id="id98">
<h1>)<a class="headerlink" href="#id98" title="Link to this heading">ÔÉÅ</a></h1>
<p>3. <strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–¥–∞–∫—à–Ω –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:</strong>
<a href="#id99"><span class="problematic" id="id100">``</span></a><a href="#id101"><span class="problematic" id="id102">`</span></a>python
# –ó–∞–º–µ–Ω–∏—Ç–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤ –ø–∞–º—è—Ç–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
import asyncpg</p>
<dl>
<dt>async def store_payment(payment_data):</dt><dd><p>conn = await asyncpg.connect(DATABASE_URL)
await conn.execute(</p>
<blockquote>
<div><p>‚ÄúINSERT INTO payments (user_id, amount, stage_id, created_at) VALUES ($1, $2, $3, NOW())‚Äù,
payment_data[‚Äòuser_id‚Äô], payment_data[‚Äòamount‚Äô], payment_data[‚Äòstage_id‚Äô]</p>
</div></blockquote>
<p>)
await conn.close()</p>
</dd>
</dl>
<p><a href="#id103"><span class="problematic" id="id104">``</span></a><a href="#id105"><span class="problematic" id="id106">`</span></a></p>
<p>### –ö–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–ª–∞—Ç–µ–∂–∏?</p>
<p><a href="#id107"><span class="problematic" id="id108">``</span></a><a href="#id109"><span class="problematic" id="id110">`</span></a>python
class PaymentMonitor:</p>
<blockquote>
<div><dl>
<dt>def __init__(self):</dt><dd><p>self.payment_stats = defaultdict(int)</p>
</dd>
<dt>async def log_payment(self, result):</dt><dd><p>self.payment_stats[‚Äòtotal_payments‚Äô] += 1
self.payment_stats[‚Äòtotal_amount‚Äô] += result.amount</p>
<p># –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
await self.store_payment_log(result)</p>
<p># –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º –æ–±—ä–µ–º–µ
if self.payment_stats[‚Äòtotal_payments‚Äô] % 100 == 0:</p>
<blockquote>
<div><p>await self.send_volume_alert()</p>
</div></blockquote>
</dd>
<dt>async def get_stats(self):</dt><dd><p>return dict(self.payment_stats)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id111"><span class="problematic" id="id112">``</span></a><a href="#id113"><span class="problematic" id="id114">`</span></a></p>
<p>### –ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫?</p>
<p><a href="#id115"><span class="problematic" id="id116">``</span></a><a href="#id117"><span class="problematic" id="id118">`</span></a>python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
import asyncpg</p>
<dl>
<dt>class DatabasePool:</dt><dd><dl>
<dt>def __init__(self, database_url: str):</dt><dd><p>self.pool = None
self.database_url = database_url</p>
</dd>
<dt>async def initialize(self):</dt><dd><dl class="simple">
<dt>self.pool = await asyncpg.create_pool(</dt><dd><p>self.database_url,
min_size=10,
max_size=20</p>
</dd>
</dl>
<p>)</p>
</dd>
<dt>async def execute(self, query, <a href="#id119"><span class="problematic" id="id120">*</span></a>args):</dt><dd><dl class="simple">
<dt>async with self.pool.acquire() as conn:</dt><dd><p>return await conn.execute(query, <a href="#id121"><span class="problematic" id="id122">*</span></a>args)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id123"><span class="problematic" id="id124">``</span></a><a href="#id125"><span class="problematic" id="id126">`</span></a></p>
<p>## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</p>
<p>### –ü–ª–∞—Ç–µ–∂ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong>
1. –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞
3. –≠—Ç–∞–ø –ø–ª–∞—Ç–µ–∂–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π</p>
<p><a href="#id127"><span class="problematic" id="id128">``</span></a><a href="#id129"><span class="problematic" id="id130">`</span></a>python
# –û—Ç–ª–∞–¥–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–ª–∞—Ç–µ–∂–∞
async def debug_send_payment(user_id: int, stage_id: str):</p>
<blockquote>
<div><p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —ç—Ç–∞–ø
stage = neonpay.get_payment_stage(stage_id)
if not stage:</p>
<blockquote>
<div><p>print(f‚Äù–≠—Ç–∞–ø {stage_id} –Ω–µ –Ω–∞–π–¥–µ–Ω‚Äù)
return</p>
</div></blockquote>
<p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
try:</p>
<blockquote>
<div><p>user = await bot.get_chat(user_id)
print(f‚Äù–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω: {user.first_name}‚Äù)</p>
</div></blockquote>
<dl class="simple">
<dt>except Exception as e:</dt><dd><p>print(f‚Äù–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω: {e}‚Äù)
return</p>
</dd>
</dl>
<p># –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂
try:</p>
<blockquote>
<div><p>await neonpay.send_payment(user_id, stage_id)
print(‚Äú–ü–ª–∞—Ç–µ–∂ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ‚Äù)</p>
</div></blockquote>
<dl class="simple">
<dt>except Exception as e:</dt><dd><p>print(f‚Äù–ü–ª–∞—Ç–µ–∂ –Ω–µ —É–¥–∞–ª—Å—è: {e}‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id131"><span class="problematic" id="id132">``</span></a><a href="#id133"><span class="problematic" id="id134">`</span></a></p>
<p>### Callback –ø–ª–∞—Ç–µ–∂–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong>
1. –î–µ–∫–æ—Ä–∞—Ç–æ—Ä <cite>&#64;neonpay.on_payment</cite> –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω
2. –§—É–Ω–∫—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
3. –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</p>
<p><a href="#id135"><span class="problematic" id="id136">``</span></a><a href="#id137"><span class="problematic" id="id138">`</span></a>python
# –¢–µ—Å—Ç callback –ø–ª–∞—Ç–µ–∂–∞
&#64;neonpay.on_payment
async def test_payment_handler(result):</p>
<blockquote>
<div><p>print(f‚ÄùCallback –ø–ª–∞—Ç–µ–∂–∞ —Å—Ä–∞–±–æ—Ç–∞–ª: {result}‚Äù)
# –î–æ–±–∞–≤—å—Ç–µ —Ç–æ—á–∫—É –æ—Å—Ç–∞–Ω–æ–≤–∞ –∑–¥–µ—Å—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</p>
</div></blockquote>
<p><a href="#id139"><span class="problematic" id="id140">``</span></a><a href="#id141"><span class="problematic" id="id142">`</span></a></p>
<p>### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong>
1. –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
2. –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω
3. –ö–æ–º–∞–Ω–¥—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
4. –°–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ</p>
<p><a href="#id143"><span class="problematic" id="id144">``</span></a><a href="#id145"><span class="problematic" id="id146">`</span></a>python
# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –±–æ—Ç–∞
async def test_bot():</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>me = await bot.get_me()
print(f‚Äù–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç: {me.first_name}‚Äù)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f‚Äù–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–æ—Ç—É –Ω–µ —É–¥–∞–ª–æ—Å—å: {e}‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id147"><span class="problematic" id="id148">``</span></a><a href="#id149"><span class="problematic" id="id150">`</span></a></p>
<p>### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö</p>
<p><a href="#id151"><span class="problematic" id="id152">``</span></a><a href="#id153"><span class="problematic" id="id154">`</span></a>python
# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
async def test_database():</p>
<blockquote>
<div><dl class="simple">
<dt>try:</dt><dd><p>conn = await asyncpg.connect(DATABASE_URL)
result = await conn.fetchval(‚ÄúSELECT 1‚Äù)
print(f‚Äù–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞: {result}‚Äù)
await conn.close()</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f‚Äù–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —É–¥–∞–ª–æ—Å—å: {e}‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id155"><span class="problematic" id="id156">``</span></a><a href="#id157"><span class="problematic" id="id158">`</span></a></p>
<p>## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã</p>
<p>### ‚Äú–≠—Ç–∞–ø –ø–ª–∞—Ç–µ–∂–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω‚Äù</p>
<p>–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂ –¥–ª—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —ç—Ç–∞–ø–∞:</p>
<p><a href="#id159"><span class="problematic" id="id160">``</span></a><a href="#id161"><span class="problematic" id="id162">`</span></a>python
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —ç—Ç–∞–ø—ã
stages = neonpay.list_payment_stages()
print(f‚Äù–î–æ—Å—Ç—É–ø–Ω—ã–µ —ç—Ç–∞–ø—ã: {list(stages.keys())}‚Äù)</p>
<p># –°–æ–∑–¥–∞—Ç—å —ç—Ç–∞–ø, –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
if ‚Äúpremium‚Äù not in stages:</p>
<blockquote>
<div><p>stage = PaymentStage(‚Äú–ü—Ä–µ–º–∏—É–º‚Äù, ‚Äú–ü—Ä–µ–º–∏—É–º –¥–æ—Å—Ç—É–ø‚Äù, 25)
neonpay.create_payment_stage(‚Äúpremium‚Äù, stage)</p>
</div></blockquote>
<p><a href="#id163"><span class="problematic" id="id164">``</span></a><a href="#id165"><span class="problematic" id="id166">`</span></a></p>
<p>### ‚Äú–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏–Ω–≤–æ–π—Å‚Äù</p>
<p>–≠—Ç–æ –æ–±—ã—á–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
1. –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞
3. ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π</p>
<p><a href="#id167"><span class="problematic" id="id168">``</span></a><a href="#id169"><span class="problematic" id="id170">`</span></a>python
# –û—Ç–ª–∞–¥–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–Ω–≤–æ–π—Å–∞
async def debug_invoice(user_id: int, stage_id: str):</p>
<blockquote>
<div><dl>
<dt>try:</dt><dd><p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–æ—Ç–µ
me = await bot.get_me()
print(f‚Äù–ë–æ—Ç: {me.first_name} (&#64;{me.username})‚Äù)</p>
<p># –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
user = await bot.get_chat(user_id)
print(f‚Äù–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user.first_name} (&#64;{user.username})‚Äù)</p>
<p># –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–ª–∞—Ç–µ–∂
await neonpay.send_payment(user_id, stage_id)</p>
</dd>
<dt>except Exception as e:</dt><dd><p>print(f‚Äù–û—à–∏–±–∫–∞: {e}‚Äù)</p>
</dd>
</dl>
</div></blockquote>
<p><a href="#id171"><span class="problematic" id="id172">``</span></a><a href="#id173"><span class="problematic" id="id174">`</span></a></p>
<p>### ‚ÄúCallback –ø–ª–∞—Ç–µ–∂–∞ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç‚Äù</p>
<p>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. –§—É–Ω–∫—Ü–∏—è –¥–µ–∫–æ—Ä–∏—Ä–æ–≤–∞–Ω–∞ <cite>&#64;neonpay.on_payment</cite>
2. –§—É–Ω–∫—Ü–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è
3. –ë–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">#</span> <span class="pre">–¢–µ—Å—Ç</span> <span class="pre">—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</span> <span class="pre">callback</span>
<span class="pre">stats</span> <span class="pre">=</span> <span class="pre">neonpay.get_stats()</span>
<span class="pre">print(f&quot;Callbacks</span> <span class="pre">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã:</span> <span class="pre">{stats['registered_callbacks']}&quot;)</span>
<span class="pre">`</span></code></p>
<p>## –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏</p>
<p>### –ì–¥–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å?</p>
<ol class="arabic simple">
<li><p><strong>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</strong>: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É [examples](../../examples/)</p></li>
<li><p><strong>–°–æ–æ–±—â–µ—Å—Ç–≤–æ</strong>: –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –Ω–∞—à–µ–º—É [Telegram —Å–æ–æ–±—â–µ—Å—Ç–≤—É](<a class="reference external" href="https://t.me/neonpay_community">https://t.me/neonpay_community</a>)</p></li>
<li><p><strong>–ü—Ä–æ–±–ª–µ–º—ã</strong>: –û—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ [GitHub](<a class="reference external" href="https://github.com/Abbasxan/neonpay/issues">https://github.com/Abbasxan/neonpay/issues</a>)</p></li>
<li><p><strong>Email</strong>: –°–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–æ [<a class="reference external" href="mailto:support&#37;&#52;&#48;neonpay&#46;com">support<span>&#64;</span>neonpay<span>&#46;</span>com</a>](<a class="reference external" href="mailto:support&#37;&#52;&#48;neonpay&#46;com">mailto:support<span>&#64;</span>neonpay<span>&#46;</span>com</a>)</p></li>
</ol>
<p>### –ö–∞–∫ —Å–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–∞—Ö?</p>
<p>–ü—Ä–∏ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∫–ª—é—á–∏—Ç–µ:
1. –í–µ—Ä—Å–∏—é Python
2. –í–µ—Ä—Å–∏—é NEONPAY
3. –ë–∏–±–ª–∏–æ—Ç–µ–∫—É –±–æ—Ç–∞ –∏ –≤–µ—Ä—Å–∏—é
4. –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –∏ —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤
5. –®–∞–≥–∏ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</p>
<p>### –ö–∞–∫ –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏?</p>
<p>–ó–∞–ø—Ä–æ—Å—ã —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —É–∂–µ
2. –û–ø–∏—à–∏—Ç–µ —Å–ª—É—á–∞–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞, –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
4. –û—Ç–∫—Ä–æ–π—Ç–µ issue –Ω–∞ GitHub</p>
<p>‚Äî</p>
<p><strong>–í—Å–µ –µ—â–µ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã? –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É [examples](../../examples/) –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π!</strong></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="API.html" class="btn btn-neutral float-left" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SECURITY.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NEONPAY Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>